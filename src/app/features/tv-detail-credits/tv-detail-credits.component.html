<section class="w-full sm:w-[70%] mx-auto max-w-[1536px] pt-[60px]">
  @if(error$ | async; as error){
  <div class="w-full py-8 flex justify-center">
    <app-error-message-template
      [title]="errorTitle"
      [message]="errorMessage"
    ></app-error-message-template>
  </div>
  } @else {
  <!--  -->

  @if((banner$|async); as banner ){
  <div class="w-full bg-[var(--bg-page-section)] sm:bg-transparent pt-6">
    <div class="flex flex-col flex-col-reverse sm:flex-row sm:space-x-6">
      <div>
        <a [routerLink]="buildDetailPath(banner.id)" [title]="banner.title">
          <div
            class="bg-cover bg-no-repeat bg-center overflow-hidden aspect-[50/22] w-full sm:w-[460px] rounded-md"
            [ngStyle]="{
              'background-image': banner.backdrop_path
                ? 'url(' +
                  TMDB_PROFILE_1000W_450H_IMG_URL +
                  banner.backdrop_path +
                  ')'
                : ''
            }"
          ></div>
        </a>
      </div>

      <div
        class="text-center pb-4 sm:py-0 flex space-x-0 space-y-2 sm:space-y-0 sm:space-x-2 sm:flex-row flex-col"
      >
        <a [routerLink]="buildDetailPath(banner.id)" [title]="banner.title">
          <h1>
            {{ banner.title }}
          </h1></a
        >
        @if(year$| async; as year){
        <h2 class="text-zinc-500">({{ year | date : "yyyy" }})</h2>
        }
      </div>
    </div>
  </div>

  }
  <div class="w-full sm:flex sm:flex-row sm:space-y-0 space-y-4 py-4">
    @if((castList$|async); as castList ){
    <div
      class="w-full sm:w-[50%] bg-[var(--bg-page-section)] sm:bg-transparent pb-6"
    >
      <div class="px-4 py-6">
        <div
          class="flex justify-between hover:cursor-pointer sm:hover:cursor-default"
          (click)="toggleCast()"
        >
          <h2>TV Cast</h2>
          <h5 class="content-center">{{ castList.length }}</h5>
          <div class="sm:hidden">
            <mat-icon
              aria-hidden="false"
              [fontIcon]="isHideCastContainer ? 'expand_more' : 'chevron_right'"
            ></mat-icon>
          </div>
        </div>
      </div>

      <div
        class="px-4"
        [ngClass]="{
          'hidden-container': isHideCastContainer
        }"
      >
        <ul class="p-0 m-0 space-y-4">
          @for(cast of castList; track cast){ @defer(){
          <li class="list-none w-full">
            <app-cast-crew-credit-card
              [id]="cast.id"
              [name]="cast.name"
              [role]="buildCharacterTV(cast.roles)"
              [profile_path]="cast.profile_path"
              [direction]="'vertical'"
            ></app-cast-crew-credit-card>
          </li>
          } }
        </ul>
      </div>
    </div>
    }
    <div
      class="w-full sm:w-[50%] bg-[var(--bg-page-section)] sm:bg-transparent pb-6"
    >
      <div class="px-4 py-6">
        <div
          class="w-full flex justify-between hover:cursor-pointer sm:hover:cursor-default"
          (click)="toggleCrew()"
        >
          <h2>TV Crew</h2>
          <h5 class="content-center">{{ crewLength }}</h5>
          <div class="sm:hidden">
            <mat-icon
              aria-hidden="false"
              [fontIcon]="isHideCrewContainer ? 'expand_more' : 'chevron_right'"
            ></mat-icon>
          </div>
        </div>
      </div>

      <div
        class="px-4 space-y-8"
        [ngClass]="{
          'hidden-container': isHideCrewContainer
        }"
      >
        @if((departments$ | async); as departments){ @for(department of
        departments; track department){ @if(department.value.length >0){
        <div class="space-y-4">
          <h3>{{ department.key }}</h3>
          <ul class="p-0 m-0 space-y-4">
            @for(crew of department.value; track crew){ @defer(){
            <li class="list-none w-full">
              <app-cast-crew-credit-card
                [id]="crew.id"
                [name]="crew.name"
                [role]="buildJobTV(crew.jobs)"
                [profile_path]="crew.profile_path"
                [direction]="'vertical'"
              ></app-cast-crew-credit-card>
            </li>
            } }
          </ul>
        </div>
        } } }
      </div>
    </div>
  </div>
  }
</section>
